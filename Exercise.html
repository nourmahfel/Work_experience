<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="practical-quality-control-and-trimming">Practical: Quality Control and Trimming</h1>
<p>In this practical, you will learn to import, view, and check the quality of raw high-throughput sequencing data using FastQC and Trimmomatic (via Docker).</p>
<p>The first dataset is from an Illumina MiSeq sequencing of <em>enterohaemorrhagic E. coli</em> (EHEC), serotype O157 â€” a potentially fatal gastrointestinal pathogen involved in a 2011 outbreak in St. Louis, USA. The data is paired-end 2Ã—150 bp reads.</p>
<hr>
<h2 id="working-directory">Working Directory</h2>
<h3 id="create-a-working-directory">Create a working directory</h3>
<pre class="hljs"><code><div>mkdir ~/work
<span class="hljs-built_in">cd</span> ~/work
</div></code></pre>
<h2 id="downloading-the-data">Downloading the Data</h2>
<p>ðŸ§ª In this practical, you will use the <a href="https://www.ebi.ac.uk/ena/browser/home">European Nucleotide Archive</a> (ENA) to download real Illumina sequencing data for quality control and trimming exercises. ENA is a public database that stores nucleotide sequencing data, such as DNA and RNA sequences, submitted by researchers around the world.</p>
<p>It is part of the EMBL-EBI (European Bioinformatics Institute). ENA provides free access to raw sequencing reads, genome assemblies, and functional annotation. Accession numbers like SRR957824 are unique IDs that help you find specific datasets.</p>
<p>The raw data is available on ENA under accession number SRR957824.</p>
<h3 id="step-1-download-data">Step 1: Download data</h3>
<pre class="hljs"><code><div>wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR957/SRR957824/SRR957824_1.fastq.gz
wget ftp://ftp.sra.ebi.ac.uk/vol1/fastq/SRR957/SRR957824/SRR957824_2.fastq.gz
</div></code></pre>
<hr>
<h3 id="step-2-check-file-size">Step 2: Check file size</h3>
<pre class="hljs"><code><div>ls -l
</div></code></pre>
<p>There are 500 000 paired-end reads taken randomly from the original data</p>
<p>One last thing before we get to the quality control: those files are writeable. By default, UNIX makes things writeable by the file owner. This poses an issue with creating typos or errors in raw data. We fix that before going further</p>
<pre class="hljs"><code><div>chmod u-w *
</div></code></pre>
<hr>
<h3 id="step-3-preview-a-fastq-file">Step 3: Preview a FASTQ file</h3>
<pre class="hljs"><code><div>zless SRR957824_1.fastq.gz
</div></code></pre>
<h2 id="tip-use-the-spacebar-to-scroll-and-q-to-exit"><strong>Tip:</strong> Use the spacebar to scroll and <code>q</code> to exit.</h2>
<p>The fastq format is a text-based format that represents nucleotide sequences but also contains the corresponding quality of each nucleotide. It is the standard for storing the output of high-throughput sequencing instruments such as the Illumina machines.</p>
<p>A fastq file uses four lines per sequence:</p>
<p>Line 1 begins with a '@' character and is followed by a sequence identifier and an optional description (like a FASTA title line).</p>
<p>Line 2 is the raw sequence of letters.</p>
<p>Line 3 begins with a '+' character and is optionally followed by the same sequence identifier (and any description) again.</p>
<p>Line 4 encodes the quality values for the sequence in Line 2, and must contain the same number of symbols as letters in the sequence.</p>
<p>You can read more on the FASTQ format <a href="https://www.hadriengourle.com/tutorials/file_formats/">here</a>.</p>
<hr>
<p><strong>Question:</strong> Where does the filename come from?</p>
<p><strong>Question:</strong> Why are there <code>_1</code> and <code>_2</code> in the file names?</p>
<hr>
<h2 id="fastqc-pre-trimming-quality-check">FastQC (Pre-Trimming Quality Check)</h2>
<p>To check the quality of the sequence data, we will use a tool called FastQC.</p>
<p>FastQC has a graphical interface and can be downloaded and run on a Windows or Linux computer without installation. It is available <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">here</a>.</p>
<p>However, FastQC is also available as a command-line utility in Docker. Docker makes things simple and consistent. Instead of installing software like FastQC or Trimmomatic yourself, Docker lets you download small packages (called containers) that already have everything set up. You can then run them directly on your data using simple commands. Docker makes it easy to run bioinformatics tools without worrying about installation or compatibility.</p>
<p>Think of Docker like a shipping container for software. Just like shipping containers hold goods and can be transported anywhere, Docker containers hold software and can run anywhere: on your laptop, a lab server, or the cloud without needing to be unpacked or reinstalled. Everything the program needs is bundled inside.</p>
<h3 id="step-1-pull-the-fastqc-docker-image">Step 1: Pull the FastQC Docker image</h3>
<pre class="hljs"><code><div>docker pull biocontainers/fastqc:v0.11.9_cv8
</div></code></pre>
<hr>
<h3 id="step-2-run-fastqc-in-docker">Step 2: Run FastQC in Docker</h3>
<pre class="hljs"><code><div>docker run --rm -v <span class="hljs-string">"<span class="hljs-variable">$PWD</span>"</span>:/data biocontainers/fastqc:v0.11.9_cv8 fastqc /data/SRR957824_1.fastq.gz /data/SRR957824_2.fastq.gz
</div></code></pre>
<hr>
<h3 id="step-3-list-output-files">Step 3: List output files</h3>
<pre class="hljs"><code><div>ls *fastqc*
</div></code></pre>
<p>For each file, FastQC has produced both a .zip archive containing all the plots and a HTML report.
Download and open the HTML files with your favourite web browser.</p>
<hr>
<p><strong>Question:</strong> What should you pay attention to in the FastQC report?</p>
<p><strong>Question:</strong> Which file is of better quality?</p>
<p>Pay special attention to:</p>
<ul>
<li>Per-base sequence quality</li>
<li>Sequence length distribution</li>
<li>Adapter content</li>
</ul>
<p>Explanations for the various quality modules can be found <a href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/">here</a>. Also, have a look at examples of a good and a bad illumina read set for comparison.
You will note that the reads in your uploaded dataset have fairly poor quality (&lt;20) towards the end. There are also outlier reads that have very poor quality for most of the second half of the reads.</p>
<hr>
<h2 id="adapter-trimming-with-trimmomatic">Adapter Trimming with Trimmomatic</h2>
<p>Trimmomatic is a tool that removes adapter sequences and trims low-quality regions from sequencing reads. It works by:</p>
<p>Scanning the reads for known adapter sequences using exact or partial matches.
Removing low-quality bases from the start and end of each read.
Trimming using a sliding window that checks the average quality within a region.
Discarding reads that are too short after trimming.</p>
<p>It helps clean up the data so that poor-quality sequences don't interfere with downstream analysis.</p>
<h3 id="step-1-download-the-adapter-file">Step 1: Download the adapter file</h3>
<pre class="hljs"><code><div>curl -O -J -L https://osf.io/v24pt/download -o adapters.fa
</div></code></pre>
<hr>
<h3 id="step-2-pull-trimmomatic-docker-image">Step 2: Pull Trimmomatic Docker image</h3>
<pre class="hljs"><code><div>docker pull quay.io/biocontainers/trimmomatic:0.39--hdfd78af_2
</div></code></pre>
<hr>
<h3 id="step-3-run-trimmomatic-paired-end">Step 3: Run Trimmomatic (paired-end)</h3>
<pre class="hljs"><code><div>docker run --rm -v <span class="hljs-string">"<span class="hljs-variable">$PWD</span>"</span>:/data quay.io/biocontainers/trimmomatic:0.39--hdfd78af_2 trimmomatic PE -phred33   /data/SRR957824_1.fastq.gz /data/SRR957824_2.fastq.gz   /data/trimmed_1.fastq /data/trimmed_1_unpaired.fastq   /data/trimmed_2.fastq /data/trimmed_2_unpaired.fastq   ILLUMINACLIP:/data/adapters.fasta:2:30:10   LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36
</div></code></pre>
<hr>
<p><strong>Question:</strong> What adapters were used, and how does Trimmomatic identify them?</p>
<p><strong>Question:</strong> What are the unpaired FASTQ files, and why are they generated?</p>
<hr>
<h2 id="fastqc-post-trimming-quality-check">FastQC (Post-Trimming Quality Check)</h2>
<h3 id="step-1-run-fastqc-again-on-filtered-reads">Step 1: Run FastQC again on filtered reads</h3>
<pre class="hljs"><code><div>docker run --rm -v <span class="hljs-string">"<span class="hljs-variable">$PWD</span>"</span>:/data biocontainers/fastqc:v0.11.9_cv8 fastqc /data/trimmed_1.fastq /data/trimmed_2.fastq
</div></code></pre>
<hr>
<h3 id="step-2-list-outputs">Step 2: List outputs</h3>
<pre class="hljs"><code><div>ls *trimmed*_fastqc.html
</div></code></pre>
<hr>
<p>Open both <code>.html</code> files in your browser and look at the reports.</p>
<p><strong>Question:</strong> What improvements are visible after trimming?</p>
<p><strong>Question:</strong> How did trimming affect per-base quality and read lengths?</p>
<hr>
<h2 id="additional-questions-about-fastqc">Additional Questions about FastQC</h2>
<p><strong>Question:</strong> Which FastQC modules showed the most improvement after trimming?</p>
<p><strong>Question:</strong> Did the adapter content change after trimming? How can you tell?</p>
<p><strong>Question:</strong> How does the sequence length distribution look after trimming compared to before?</p>
<p><strong>Question:</strong> Would you expect every dataset to need trimming? Why or why not?</p>
<p><strong>Question:</strong> What are the potential consequences of skipping quality control and trimming in a diagnostic laboratory?</p>
<hr>
<h2 id="summary">Summary</h2>
<ul>
<li>You downloaded and inspected paired-end Illumina reads.</li>
<li>Used Docker-based FastQC to assess raw data.</li>
<li>Trimmed adapters and low-quality regions using Trimmomatic.</li>
<li>Verified improvements using FastQC.</li>
</ul>
<p>This workflow ensures data quality and prepares reads for reliable downstream analysis.</p>

</body>
</html>
